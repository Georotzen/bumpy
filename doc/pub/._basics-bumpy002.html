<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="A very basic introduction to scientific Python programming">
<meta name="keywords" content="text editor,program file,assignment statement,print statement,variable,objects,formatting of numbers,printf syntax,format string syntax,while loop,boolean expression,Python Online Tutor,list,for loop,list comprehension,array,mathematical functions,import of modules,plotting,graphics,visualization,function (in Python),global variables,keyword arguments,default arguments,vectorization,vectorized functions,multiple return values,branching,if test,boolean expression,vectorizing if tests">

<title>A very basic introduction to scientific Python programming</title>

<!-- Bootstrap style: bootstrap -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Variables, loops, lists, and arrays ',
               1,
               'basics:basic:objects',
               'basics:basic:objects'),
              (' Getting access to Python ',
               2,
               'basics:accesspy',
               'basics:accesspy'),
              (' Mac and Windows ', 3, None, '___sec2'),
              (' Ubuntu ', 3, None, '___sec3'),
              (' Web access ', 3, None, '___sec4'),
              (' Mathematical example ', 2, None, '___sec5'),
              (' A program for evaluating a formula ',
               2,
               'basics:formula:eval',
               'basics:formula:eval'),
              (' Formatted output with text and numbers ',
               2,
               'basics:printf',
               'basics:printf'),
              (' While loops ', 2, 'basics:while', 'basics:while'),
              (' Lists ', 2, 'basics:list', 'basics:list'),
              (' For loops ', 2, 'basics:for', 'basics:for'),
              (' Arrays ', 2, 'basics:numpy', 'basics:numpy'),
              (' Mathematical functions ', 2, 'basics:math', 'basics:math'),
              (' Plotting ', 2, 'basics:plot', 'basics:plot'),
              (' Functions and branching ',
               1,
               'basics:func:branching',
               'basics:func:branching'),
              (' Functions ', 2, 'basics:func', 'basics:func'),
              (' A more general mathematical formula ',
               2,
               'basics:formula:piecewise',
               'basics:formula:piecewise'),
              (' If tests ', 2, 'basics:if', 'basics:if'),
              (' Using the `where` function ', 3, None, '___sec18'),
              (' Using array indexing ', 3, None, '___sec19'),
              (' Files ', 1, 'basics:files', 'basics:files'),
              (' File reading ', 2, None, '___sec21'),
              (' File writing ', 2, None, '___sec22'),
              (' Classes ', 1, 'basics:class', 'basics:class'),
              (' A very simple class ', 2, None, '___sec24'),
              (' A class for representing a mathematical function ',
               2,
               None,
               '___sec25'),
              (' The class code ', 3, None, '___sec26'),
              (' Dissection ', 3, None, '___sec27'),
              (' Exercises ', 1, 'basics:exer', 'basics:exer'),
              (' Exercise 1: Program a formula ',
               2,
               'basics:exer:formula1',
               'basics:exer:formula1'),
              (' Exercise 2: Combine text and numbers in output ',
               2,
               'basics:exer:printf1',
               'basics:exer:printf1'),
              (' Exercise 3: Program a while loop ',
               2,
               'basics:exer:while1',
               'basics:exer:while1'),
              (' Exercise 4: Create a list with a while loop ',
               2,
               'basics:exer:while2',
               'basics:exer:while2'),
              (' Exercise 5: Program a for loop ',
               2,
               'basics:exer:for1',
               'basics:exer:for1'),
              (' Exercise 6: Create a list with a for loop ',
               2,
               'basics:exer:for2',
               'basics:exer:for2'),
              (' Exercise 7: Write a Python function ',
               2,
               'basics:exer:func1',
               'basics:exer:func1'),
              (' Exercise 8: Return three values from a Python function ',
               2,
               'basics:exer:func3',
               'basics:exer:func3'),
              (' Exercise 9: Plot a function ',
               2,
               'basics:exer:plot1',
               'basics:exer:plot1'),
              (' Exercise 10: Measure the efficiency of vectorization ',
               2,
               'basics:exer:timeit',
               'basics:exer:timeit')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="basics-bumpy.html">A very basic introduction to scientific Python programming</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._basics-bumpy001.html#basics:basic:objects" style="font-size: 80%;">Variables, loops, lists, and arrays</a></li>
     <!-- navigation toc: --> <li><a href="#basics:func:branching" style="font-size: 80%;">Functions and branching</a></li>
     <!-- navigation toc: --> <li><a href="._basics-bumpy003.html#basics:files" style="font-size: 80%;">Files</a></li>
     <!-- navigation toc: --> <li><a href="._basics-bumpy004.html#basics:class" style="font-size: 80%;">Classes</a></li>
     <!-- navigation toc: --> <li><a href="._basics-bumpy005.html#basics:exer" style="font-size: 80%;">Exercises</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0002"></a>
<!-- !split -->

<h1 id="basics:func:branching">Functions and branching</h1>

<h2 id="basics:func">Functions</h2>

<p>
Since \( s(t) \) is a function in mathematics, it is convenient to have
it as a function in Python too:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s</span>(t):
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

v0 <span style="color: #666666">=</span> <span style="color: #666666">0.2</span>
a <span style="color: #666666">=</span> <span style="color: #666666">4</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>)   <span style="color: #408080; font-style: italic"># Call the function</span>
</pre></div>
<p>
Note that

<ul>
 <li> functions start with the keyword <code>def</code></li>
 <li> statements belonging to the function must be indented</li>
 <li> function input is represented by arguments
   (separated by comma if more than one)</li>
 <li> function output is returned to the calling code</li>
</ul>

In this program, <code>v0</code> and <code>a</code> are <em>global variables</em>, which must be
defined before calling the <code>s(t)</code> function, otherwise <code>v0</code> and <code>a</code>
becomes undefined variables in the expression inside the function.

<p>
Instead of having <code>v0</code> and <code>a</code> as global variables, we may let them be
function arguments:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s</span>(t, v0, a):
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, <span style="color: #666666">0.2</span>, <span style="color: #666666">4</span>)   <span style="color: #408080; font-style: italic"># Call the function</span>

<span style="color: #408080; font-style: italic"># More readable call</span>
value <span style="color: #666666">=</span> s(t<span style="color: #666666">=3</span>, v0<span style="color: #666666">=0.2</span>, a<span style="color: #666666">=4</span>)
</pre></div>
<p>
Function arguments may also be declared to have a default value,
allowing us to drop the argument in the call if the default value
is appropriate. Such arguments are called <em>keyword arguments</em> or
<em>default arguments</em>. Here is an example:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s</span>(t, v0<span style="color: #666666">=1</span>, a<span style="color: #666666">=1</span>):
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, <span style="color: #666666">0.2</span>, <span style="color: #666666">4</span>)         <span style="color: #408080; font-style: italic"># specify new v0 and a</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>)                 <span style="color: #408080; font-style: italic"># rely on v0=1 and a=1</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, a<span style="color: #666666">=2</span>)            <span style="color: #408080; font-style: italic"># rely on v0=1</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, v0<span style="color: #666666">=2</span>)           <span style="color: #408080; font-style: italic"># rely on a=1</span>
value <span style="color: #666666">=</span> s(t<span style="color: #666666">=3</span>, v0<span style="color: #666666">=2</span>, a<span style="color: #666666">=2</span>)    <span style="color: #408080; font-style: italic"># specify everything</span>
value <span style="color: #666666">=</span> s(a<span style="color: #666666">=2</span>, t<span style="color: #666666">=3</span>, v0<span style="color: #666666">=2</span>)    <span style="color: #408080; font-style: italic"># any sequence allowed</span>
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Notice.</b>

<ul>
 <li> Arguments without the argument name are called <em>positional arguments</em>.</li>
 <li> Positional arguments must always be listed before the keyword arguments
   in the function and in any call.</li>
 <li> The sequence of the keyword arguments can be arbitrary.</li>
 <li> If argument names are used for all arguments (as in the last line above)
   the sequence of the arguments is not important.</li>
</ul>
</div>


<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Vectorized functions.</b>
Applying the function <code>s(t, v0, a)</code> to an array <code>t</code> can be done
in two ways:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Scalar code: work with one element at a time</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(t)):
    s_values[i] <span style="color: #666666">=</span> s(t_values[i], v0, a)

<span style="color: #408080; font-style: italic"># Vectorized code: apply s to the entire array</span>
s_values <span style="color: #666666">=</span> s(t_values, v0, a)
</pre></div>
<p>
For the last line to work, the function <code>s</code> must contain statements
that work correctly when <code>t</code> is an array argument.

<p>
The advantage of vectorized code is that we avoid a loop in Python.
Instead, we carry out mathematical operations on entire arrays, e.g.,
<code>v0*t</code> and <code>a*t**2</code>. Technically, such (binary) operations are
executed as loops in very fast (compiled) C code.
</div>


<p>
A function can return more than one value, say \( s(t) \) and the
velocity \( s'(t)=v_0 + at \):

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">movement</span>(t, v0, a):
    s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
    v <span style="color: #666666">=</span> v0 <span style="color: #666666">+</span> a<span style="color: #666666">*</span>t
    <span style="color: #008000; font-weight: bold">return</span> s, v

s_value, v_value <span style="color: #666666">=</span> movement(t<span style="color: #666666">=0.2</span>, v0<span style="color: #666666">=2</span>, a<span style="color: #666666">=4</span>)
</pre></div>
<p>
When \( n \) values are returned, we list \( n \) variables on the left-hand
side in the call.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Python functions return only one object.</b>
Even when we return several values, as in <code>return s, v</code>, actually only
one object is returned. The <code>s</code> and <code>v</code> values are packed together
in a <em>tuple</em> object (which is very similar to a list).

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">+1</span>, x<span style="color: #666666">+2</span>, x<span style="color: #666666">+3</span>
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> r <span style="color: #666666">=</span> f(<span style="color: #666666">3</span>)     <span style="color: #408080; font-style: italic"># Store all three return values in one object r</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> r
(<span style="color: #666666">4</span>, <span style="color: #666666">5</span>, <span style="color: #666666">6</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">type</span>(r)      <span style="color: #408080; font-style: italic"># What type of object is r?</span>
<span style="color: #666666">&lt;</span><span style="color: #008000">type</span> <span style="color: #BA2121">&#39;tuple&#39;</span><span style="color: #666666">&gt;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> r[<span style="color: #666666">1</span>]
<span style="color: #666666">5</span>
</pre></div>
<p>
Tuples are constant lists, so you can index them as lists, but you cannot
change the contents (<code>append</code> or <code>del</code> is illegal).
</div>


<h2 id="basics:formula:piecewise">A more general mathematical formula</h2>

<p>
The formula <a href="._basics-bumpy001.html#mjx-eqn-1">(1)</a> arises from the basic differential
equations in kinematics:

$$
\begin{align}
v = \frac{ds}{dt},\quad s(0)=s_0,
\tag{2}\\ 
a = \frac{dv}{dt},\quad v(0)=v_0\thinspace .
\tag{3}
\end{align}
$$

Given any acceleration \( a(t) \), we can solve for \( s(t) \) through integration.
First, we integrate to find \( v(t) \):

$$ \int_0^t a(t)dt = \int_0^t \frac{dv}{dt} dt,$$

which gives

$$ v(t) = v_0 + \int_0^t a(t)dt\thinspace . $$

Then we integrate again over \( [0,t] \) to find \( s(t) \):

$$
\begin{equation}
s(t) = s_0 + v_0t + \int_0^t\left( \int_0^t a(t)dt \right) dt\thinspace .
\tag{4}
\end{equation}
$$


<p>
Suppose we have some constant acceleration \( a_0 \) in \( [0,t_1] \) and no
acceleration thereafter. We find

$$
\begin{equation}
s(t) = \left\lbrace\begin{array}{ll}
s_0 + v_0 t + \frac{1}{2}a_0 t^2,& t\leq t_1\\ 
s_0 + v_0t_1 + \frac{1}{2}a_0 t_1^2 + a_0t_1(t-t_1),& t> t_1
\end{array}\right.
\tag{5}
\end{equation}
$$


<p>
To implement a function like <a href="#mjx-eqn-5">(5)</a>, we need to
branch into one type of code (formula) if \( t\leq t_1 \) and another
type of code (formula) if \( t>t_1 \). This is called <em>branching</em> and
the <em>if test</em> is the primary construction to use.

<h2 id="basics:if">If tests</h2>

<p>
An if test has the structure

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">if</span> condition:
    <span style="color: #666666">&lt;</span>statements when condition <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #666666">&lt;</span>statements when condition <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">False</span><span style="color: #666666">&gt;</span>
</pre></div>
<p>
Here, <code>condition</code> is a boolean expression that evaluates to <code>True</code> or
<code>False</code>. For the piecewisely defined function <a href="#mjx-eqn-5">(5)</a>
we would use an if test in the implementation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">if</span> t <span style="color: #666666">&lt;=</span> t1:
    s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
<span style="color: #008000; font-weight: bold">else</span>:
    s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1)
</pre></div>
<p>
The <code>else</code> part can be omitted when not needed. Several branches are
also possible:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">if</span> condition1:
    <span style="color: #666666">&lt;</span>statements when condition1 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">elif</span> condition2:
    <span style="color: #666666">&lt;</span>statements when condition1 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">False</span> <span style="color: #AA22FF; font-weight: bold">and</span> condition2 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">elif</span> condition3:
    <span style="color: #666666">&lt;</span>statements when condition1 <span style="color: #AA22FF; font-weight: bold">and</span> conditon <span style="color: #666666">2</span> are <span style="color: #008000">False</span>
     <span style="color: #AA22FF; font-weight: bold">and</span> condition3 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #666666">&lt;</span>statements when condition1<span style="color: #666666">/2/3</span> <span style="color: #008000">all</span> are <span style="color: #008000">False</span><span style="color: #666666">&gt;</span>
</pre></div>
<p>
A Python function implementing the mathematical function <a href="#mjx-eqn-5">(5)</a>
reads

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s_func</span>(t, v0, a0, t1):
    <span style="color: #008000; font-weight: bold">if</span> t <span style="color: #666666">&lt;=</span> t1:
        s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1)
    <span style="color: #008000; font-weight: bold">return</span> s
</pre></div>
<p>
To plot this \( s(t) \), we need to compute points on the curve.
Trying to call <code>s_func</code> with an array <code>t</code> as argument will not
work because of the if test. In general, functions with if tests
will not automatically work with arrays because a test
like <code>if t &lt;= t1</code> evaluates to an if applied to a boolean
array (<code>t &lt;= t1</code> becomes a boolean array, not just a boolean).

<p>
One solution is to compute the function values one by one in a loop
such that the <code>s</code> function is always called with a scalar value for <code>t</code>.
Appropriate code is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">n <span style="color: #666666">=</span> <span style="color: #666666">201</span>  <span style="color: #408080; font-style: italic"># No of t values for plotting</span>
t1 <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>

t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">2</span>, n<span style="color: #666666">+1</span>)
s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n<span style="color: #666666">+1</span>)
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(t)):
    s[i] <span style="color: #666666">=</span> s_func(t<span style="color: #666666">=</span>t[i], v0<span style="color: #666666">=0.2</span>, a0<span style="color: #666666">=20</span>, t1<span style="color: #666666">=</span>t1)
</pre></div>
<p>
Relevant statements for plotting are now

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">plt<span style="color: #666666">.</span>plot(t, s, <span style="color: #BA2121">&#39;b-&#39;</span>)
plt<span style="color: #666666">.</span>plot([t1, t1], [<span style="color: #666666">0</span>, s_func(t<span style="color: #666666">=</span>t1, v0<span style="color: #666666">=0.2</span>, a0<span style="color: #666666">=20</span>, t1<span style="color: #666666">=</span>t1)], <span style="color: #BA2121">&#39;r--&#39;</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;t&#39;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;s&#39;</span>)
plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;myplot.png&#39;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Vectorization of functions with if tests.</b>
To vectorize the computation of the array of \( s(t) \) values, i.e.,
avoid a loop where <code>s_func</code> is called for each <code>t[i]</code> element,
we must completely rewrite the if test. There are two methods:
the <code>numpy.where</code> function and array indexing.

<h3 id="___sec18">Using the <code>where</code> function </h3>

<p>
A vectorized if-else test can be coded as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%">s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition, s1, s2)
</pre></div>
<p>
Here, <code>condition</code> is an array of boolean values, and
<code>s[i] = s1[i]</code> if <code>condition[i]</code> is <code>True</code>, and otherwise <code>s[i] = s2[i]</code>.

<p>
Our example then becomes

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%">s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(t <span style="color: #666666">&lt;=</span> t1,
             v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>,
             v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1))
</pre></div>
<p>
Note that <code>t &lt;= t1</code> with array <code>t</code> and scalar <code>t1</code> results in a boolean
array <code>b</code> where <code>b[i] = t[i] &lt;= t1</code>.

<h3 id="___sec19">Using array indexing </h3>

<p>
It is possible to index a subset of indices in an array <code>s</code> using
a boolean array <code>b</code>: <code>s[b]</code>. This construction picks out all the
elements <code>s[i]</code> where <code>b[i]</code> is <code>True</code>. On the right-hand side
we can then assign some array expression <code>expr</code> of the same length
as <code>s[b]</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%">s[b] <span style="color: #666666">=</span> (expr)[b]
</pre></div>
<p>
Our example can utilize this technique with <code>b</code> as <code>t &lt;= t1</code> and <code>t &gt; t1</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%">s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros_like(t)  <span style="color: #408080; font-style: italic"># Make s as zeros, same size &amp; type as t</span>
s[t <span style="color: #666666">&lt;=</span> t1] <span style="color: #666666">=</span> (v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>)[t <span style="color: #666666">&lt;=</span> t1]
s[t <span style="color: #666666">&gt;</span> t1]  <span style="color: #666666">=</span> (v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1))[t <span style="color: #666666">&gt;</span> t1]
</pre></div>
<p>
</div>


<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._basics-bumpy001.html">&laquo;</a></li>
  <li><a href="._basics-bumpy000.html">1</a></li>
  <li><a href="._basics-bumpy001.html">2</a></li>
  <li class="active"><a href="._basics-bumpy002.html">3</a></li>
  <li><a href="._basics-bumpy003.html">4</a></li>
  <li><a href="._basics-bumpy004.html">5</a></li>
  <li><a href="._basics-bumpy005.html">6</a></li>
  <li><a href="._basics-bumpy003.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

